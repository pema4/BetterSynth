using System;
using System.Globalization;

namespace BetterSynth
{
    class WindowedSincFilter
    {
        private static void PrintCoefficientsToConsole(double[] arr)
        {
            for (int i = 0; i < arr.Length; i += 4)
            {
                for (int j = i; j < i + 4 && j < arr.Length; ++j)
                    Console.Write($"{(arr[j]).ToString("F30", CultureInfo.InvariantCulture).TrimEnd('0')}, ");
                Console.WriteLine();
            }
        }

        public static double[] X2OversamplingCoefficients = new[]
        {
            0.00000608324451343957, 0.00000167239043142966, -0.0000118501890316854, -0.00000604945833033968,
            0.0000189675674123308, 0.0000144641955423298, -0.000026588016985484, -0.0000283104281010191,
            0.0000332157643171173, 0.0000488479797373487, -0.000036620176639844, -0.0000769475368469348,
            0.0000338149949294775, 0.000112787238175477, -0.0000211276446175213, -0.000155522149775571,
            -0.00000562059620630275, 0.000202956765488823, 0.0000508095872052943, -0.000251258482572975,
            -0.000118586391083614, 0.000294755571110058, 0.000212310919349241, -0.000325865452735732,
            -0.000333904171260155, 0.000335197268565762, 0.000483137405330844, -0.000311866146224328,
            -0.000656915369759956, 0.000244045064415477, 0.000848619427630577, -0.000119763974629476,
            -0.00104758548923798, -0.000072054377742314, 0.0012387956424605, 0.00034035549323113,
            -0.00140286006536085, -0.000690568698502179, 0.00151635646509599, 0.00112315820026851,
            -0.00155257764303593, -0.00163221073579789, 0.00148271432090792, 0.00220417587690653,
            -0.0012774711092629, -0.00281688269297781, 0.00090908025653175, 0.00343895521478537,
            -0.000353642917585906, -0.00402973791014137, -0.00040630606731817, 0.00453982083616873,
            0.00137914340932373, -0.00491222287691553, -0.00256156830047012, 0.0050842516875638,
            0.00393624651877723, -0.004990013164657, -0.00546985403115754, 0.00456349411583332,
            0.00711167018864435, -0.00374209297644025, -0.0087928377210202, 0.00247042862255503,
            0.0104263559979981, -0.000704220359318521, -0.0119078041667152, -0.0015859935100514,
            0.0131166995322517, 0.00441154265100305, -0.0139182788151732, -0.00776295672370281,
            0.0141653342182581, 0.011608160430036, -0.01369951765363, -0.0158917114036536,
            0.0123511919468846, 0.0205352077435379, -0.00993634340728909, -0.0254389268452529,
            0.00624802487813378, 0.0304846844342151, -0.00103768928255277, -0.0355398258629293,
            -0.00602283899980321, 0.0404621878197364, 0.0154190082948008, -0.0451058011879797,
            -0.0279600915270491, 0.0493270509644085, 0.0451711438165919, -0.0529909706886603,
            -0.0703584749819674, 0.0559773300387597, 0.112230433855545, -0.0581861769361107,
            -0.202991620643534, 0.0595425200023323, 0.633520239260531, 0.93999815567913,
            0.633520239260531, 0.0595425200023323, -0.202991620643534, -0.0581861769361107,
            0.112230433855545, 0.0559773300387597, -0.0703584749819674, -0.0529909706886603,
            0.0451711438165919, 0.0493270509644085, -0.0279600915270491, -0.0451058011879797,
            0.0154190082948008, 0.0404621878197364, -0.00602283899980321, -0.0355398258629293,
            -0.00103768928255277, 0.0304846844342151, 0.00624802487813378, -0.0254389268452529,
            -0.00993634340728909, 0.0205352077435379, 0.0123511919468846, -0.0158917114036536,
            -0.01369951765363, 0.011608160430036, 0.0141653342182581, -0.00776295672370281,
            -0.0139182788151732, 0.00441154265100305, 0.0131166995322517, -0.0015859935100514,
            -0.0119078041667152, -0.000704220359318521, 0.0104263559979981, 0.00247042862255503,
            -0.0087928377210202, -0.00374209297644025, 0.00711167018864435, 0.00456349411583332,
            -0.00546985403115754, -0.004990013164657, 0.00393624651877723, 0.0050842516875638,
            -0.00256156830047012, -0.00491222287691553, 0.00137914340932373, 0.00453982083616873,
            -0.00040630606731817, -0.00402973791014137, -0.000353642917585906, 0.00343895521478537,
            0.00090908025653175, -0.00281688269297781, -0.0012774711092629, 0.00220417587690653,
            0.00148271432090792, -0.00163221073579789, -0.00155257764303593, 0.00112315820026851,
            0.00151635646509599, -0.000690568698502179, -0.00140286006536085, 0.00034035549323113,
            0.0012387956424605, -0.000072054377742314, -0.00104758548923798, -0.000119763974629476,
            0.000848619427630577, 0.000244045064415477, -0.000656915369759956, -0.000311866146224328,
            0.000483137405330844, 0.000335197268565762, -0.000333904171260155, -0.000325865452735732,
            0.000212310919349241, 0.000294755571110058, -0.000118586391083614, -0.000251258482572975,
            0.0000508095872052943, 0.000202956765488823, -0.00000562059620630275, -0.000155522149775571,
            -0.0000211276446175213, 0.000112787238175477, 0.0000338149949294775, -0.0000769475368469348,
            -0.000036620176639844, 0.0000488479797373487, 0.0000332157643171173, -0.0000283104281010191,
            -0.000026588016985484, 0.0000144641955423298, 0.0000189675674123308, -0.00000604945833033968,
            -0.0000118501890316854, 0.00000167239043142966, 0.00000608324451343957,
        };

        public static double[] X4OversamplingCoefficients = new[]
        {
            -0.00000514885811063239, -0.00000886157582245054, -0.00000853186663306025, -0.00000123786395965048,
            0.0000122406428629651, 0.0000260150131516146, 0.0000307544295022125, 0.0000185436024888492,
            -0.0000111106792437505, -0.0000477092868587787, -0.0000719110054667988, -0.0000641426535950983,
            -0.0000165449076771564, 0.0000580116809626626, 0.00012633919725377, 0.000147586556922546,
            0.0000944522810524166, -0.0000269142055903898, -0.000170290968455253, -0.000263668496509884,
            -0.000242119577882905, -0.0000856953165684567, 0.000157598327533959, 0.000380377916574861,
            0.000459166316250975, 0.000317059151813497, -0.0000238504727823051, -0.000431148450125366,
            -0.000707323897232884, -0.000679770536108516, -0.000297123364282478, 0.000318031722407469,
            0.000897081075537845, 0.00113557850887932, 0.000844120688552346, 0.000068764336925388,
            -0.000887725032472117, -0.00157344812251381, -0.00159166216001235, -0.00081359532666838,
            0.000508438828012, 0.001803146474863, 0.00241571034393729, 0.00192533587839171,
            0.000396479535439762, -0.00157486246011231, -0.00307609681397504, -0.00328648881129011,
            -0.00190272674136226, 0.000630392308553847, 0.00322957876014257, 0.00461841741362923,
            0.0039343885205512, 0.00121720495612072, -0.00248229544082297, -0.00548036538800552,
            -0.00620518476433087, -0.00398870978945708, 0.000480735178274944, 0.00531476188293379,
            0.00819384244100914, 0.00745010821927219, 0.00297151330113051, -0.00354052787918477,
            -0.00916958894264016, -0.011054433926223, -0.00779411567882232, -0.000318002813712498,
            0.00827106300762639, 0.013932291706742, 0.0135342434819681, 0.00649244078713364,
            -0.00462305520044426, -0.0149322464114203, -0.0193143939247397, -0.0148563144020008,
            -0.00254849011701435, 0.0126805833367312, 0.0238189858370121, 0.0248698223379967,
            0.0138771498819934, -0.00556792644123705, -0.0252552620965712, -0.0356074189984702,
            -0.0300472449905188, -0.00859986398391608, 0.0210465940385138, 0.0458739088443443,
            0.0526978010692534, 0.034271247459256, -0.00621445921378035, -0.0543925264372844,
            -0.0885661345237917, -0.0871357367903441, -0.0370372143902816, 0.0600285368638775,
            0.186190281331514, 0.311753739254658, 0.404080348208432, 0.438000818116678,
            0.404080348208432, 0.311753739254658, 0.186190281331514, 0.0600285368638775,
            -0.0370372143902816, -0.0871357367903441, -0.0885661345237917, -0.0543925264372844,
            -0.00621445921378035, 0.034271247459256, 0.0526978010692534, 0.0458739088443443,
            0.0210465940385138, -0.00859986398391608, -0.0300472449905188, -0.0356074189984702,
            -0.0252552620965712, -0.00556792644123705, 0.0138771498819934, 0.0248698223379967,
            0.0238189858370121, 0.0126805833367312, -0.00254849011701435, -0.0148563144020008,
            -0.0193143939247397, -0.0149322464114203, -0.00462305520044426, 0.00649244078713364,
            0.0135342434819681, 0.013932291706742, 0.00827106300762639, -0.000318002813712498,
            -0.00779411567882232, -0.011054433926223, -0.00916958894264016, -0.00354052787918477,
            0.00297151330113051, 0.00745010821927219, 0.00819384244100914, 0.00531476188293379,
            0.000480735178274944, -0.00398870978945708, -0.00620518476433087, -0.00548036538800552,
            -0.00248229544082297, 0.00121720495612072, 0.0039343885205512, 0.00461841741362923,
            0.00322957876014257, 0.000630392308553847, -0.00190272674136226, -0.00328648881129011,
            -0.00307609681397504, -0.00157486246011231, 0.000396479535439762, 0.00192533587839171,
            0.00241571034393729, 0.001803146474863, 0.000508438828012, -0.00081359532666838,
            -0.00159166216001235, -0.00157344812251381, -0.000887725032472117, 0.000068764336925388,
            0.000844120688552346, 0.00113557850887932, 0.000897081075537845, 0.000318031722407469,
            -0.000297123364282478, -0.000679770536108516, -0.000707323897232884, -0.000431148450125366,
            -0.0000238504727823051, 0.000317059151813497, 0.000459166316250975, 0.000380377916574861,
            0.000157598327533959, -0.0000856953165684567, -0.000242119577882905, -0.000263668496509884,
            -0.000170290968455253, -0.0000269142055903898, 0.0000944522810524166, 0.000147586556922546,
            0.00012633919725377, 0.0000580116809626626, -0.0000165449076771564, -0.0000641426535950983,
            -0.0000719110054667988, -0.0000477092868587787, -0.0000111106792437505, 0.0000185436024888492,
            0.0000307544295022125, 0.0000260150131516146, 0.0000122406428629651, -0.00000123786395965048,
            -0.00000853186663306025, -0.00000886157582245054, -0.00000514885811063239,
        };

        public static double[] X8OversamplingCoefficients = new[]
        {
            -0.00000584015136035772, -0.00000738163364194744, -0.00000771548227953916, -0.00000604936463723433,
            -0.00000167019555777424, 0.00000588850289135946, 0.0000166714875689336, 0.0000301470769602288,
            0.0000451046047844986, 0.0000596351289872085, 0.0000712206877316761, 0.000076946345094997,
            0.0000738335830470534, 0.0000592747102094479, 0.0000315280542268919, -0.00000978447276090516,
            -0.0000632493022758842, -0.000125380368217408, -0.000190559218432641, -0.000251254591119188,
            -0.000298553581044137, -0.000323000538892649, -0.000315697435554928, -0.000269575172005289,
            -0.000180704836535726, -0.0000494872510590998, 0.0001184559441381, 0.000311861316088112,
            0.000514016364354793, 0.000703658312588322, 0.000856599658433989, 0.000948014794468807,
            0.000955229408118011, 0.000860766078469844, 0.000655327084217064, 0.000340350221856186,
            -0.0000702349725986339, -0.000549388348389099, -0.00105773502507604, -0.00154587069809364,
            -0.00195817431089102, -0.00223792905483228, -0.00233337328883636, -0.00220414173896033,
            -0.0018274353090484, -0.00120319421937222, -0.000357558891633216, 0.00065600563191861,
            0.00175837283630805, 0.00284941087073271, 0.00381553726300461, 0.00453975052410284,
            0.004913394872435, 0.00484863353025055, 0.0042904017823261, 0.00322651426195524,
            0.00169463425388728, -0.00021501292078772, -0.00236198827926535, -0.00456342343711921,
            -0.00660709630389511, -0.0082690935334718, -0.00933480716212002, -0.0096215352071045,
            -0.00900060458391833, -0.00741675765824465, -0.0049025756251183, -0.00158596894642126,
            0.00231075795586101, 0.00648109155860337, 0.0105537559267555, 0.0141205471590416,
            0.0167708007971389, 0.0181299483569058, 0.0178990051814952, 0.015891465275205,
            0.0120640130113393, 0.00653772442857572, -0.000392979253466893, -0.00826548036654474,
            -0.0164689561521284, -0.0242786979256749, -0.0309029529896294, -0.0355392754274236,
            -0.0374363588856721, -0.0359566091539286, -0.0306343759815871, -0.0212248501821289,
            -0.00773915481774802, 0.00953791004644494, 0.0300497371527145, 0.0529901499724345,
            0.0773451299692528, 0.101951543103477, 0.125568925698996, 0.146959231133947,
            0.164968677759517, 0.178605548250691, 0.187108004053982, 0.189996684525939,
            0.187108004053982, 0.178605548250691, 0.164968677759517, 0.146959231133947,
            0.125568925698996, 0.101951543103477, 0.0773451299692528, 0.0529901499724345,
            0.0300497371527145, 0.00953791004644494, -0.00773915481774802, -0.0212248501821289,
            -0.0306343759815871, -0.0359566091539286, -0.0374363588856721, -0.0355392754274236,
            -0.0309029529896294, -0.0242786979256749, -0.0164689561521284, -0.00826548036654474,
            -0.000392979253466893, 0.00653772442857572, 0.0120640130113393, 0.015891465275205,
            0.0178990051814952, 0.0181299483569058, 0.0167708007971389, 0.0141205471590416,
            0.0105537559267555, 0.00648109155860337, 0.00231075795586101, -0.00158596894642126,
            -0.0049025756251183, -0.00741675765824465, -0.00900060458391833, -0.0096215352071045,
            -0.00933480716212002, -0.0082690935334718, -0.00660709630389511, -0.00456342343711921,
            -0.00236198827926535, -0.00021501292078772, 0.00169463425388728, 0.00322651426195524,
            0.0042904017823261, 0.00484863353025055, 0.004913394872435, 0.00453975052410284,
            0.00381553726300461, 0.00284941087073271, 0.00175837283630805, 0.00065600563191861,
            -0.000357558891633216, -0.00120319421937222, -0.0018274353090484, -0.00220414173896033,
            -0.00233337328883636, -0.00223792905483228, -0.00195817431089102, -0.00154587069809364,
            -0.00105773502507604, -0.000549388348389099, -0.0000702349725986339, 0.000340350221856186,
            0.000655327084217064, 0.000860766078469844, 0.000955229408118011, 0.000948014794468807,
            0.000856599658433989, 0.000703658312588322, 0.000514016364354793, 0.000311861316088112,
            0.0001184559441381, -0.0000494872510590998, -0.000180704836535726, -0.000269575172005289,
            -0.000315697435554928, -0.000323000538892649, -0.000298553581044137, -0.000251254591119188,
            -0.000190559218432641, -0.000125380368217408, -0.0000632493022758842, -0.00000978447276090516,
            0.0000315280542268919, 0.0000592747102094479, 0.0000738335830470534, 0.000076946345094997,
            0.0000712206877316761, 0.0000596351289872085, 0.0000451046047844986, 0.0000301470769602288,
            0.0000166714875689336, 0.00000588850289135946, -0.00000167019555777424, -0.00000604936463723433,
            -0.00000771548227953916, -0.00000738163364194744, -0.00000584015136035772
        };

        private double[] coefficients;
        private double[] buffer;
        private int count;

        public WindowedSincFilter(double[] coefficients)
        {
            this.coefficients = coefficients;
            this.count = 0;
        }
    }
}
